# 前端框架发展史

## 兼容性-JQuery

在`JQuery`出现之前，当时的浏览器操作`DOM`和`事件`的接口很多是不同的，遗留到现在比较常见的例子有：

**绑定事件**

```js
function addEvent(obj, type, fn, useCapTure) {
    if (obj.addEventListener) {
        obj.addEventListener(type, fn, useCapTure)
    } else {
        obj.attachEvent("on" + type, fn)
    }
}
```

**获取样式**

```js
 function getStyle(obj, attr) {
    // 非ie,google,火狐
    if (window.getComputedStyle) {
        return window.getComputedStyle(obj, null)[attr];
    }
    //ie 6 8 9
    return obj.currentStyle[attr];
 }
```

上述2个实例使用`JQuery`代码如下：

**绑定事件**

```js
$(selector).on(type, callback)
```

**获取样式**

```js
$(selector).css(name)
```

从`JQuery`和原生代码的实现来看，其代码简洁度显而易见少很多，**更重要的是开发者完全不用在写代码时，考虑特定浏览器某个API的兼容性,这是革命性的**

## 数据驱动-AngularJS

随着`ajax`技术的发展和网页交互越来越复杂，我们的前端代码不断增加，这个时候`Angular`基于常见的`MVC`架构推出了，在`Angular`诞生之前，我们的代码一般都是这样的，以`JQuery`为例：

**JQuery实现**

``` html
<!doctype html>
<html>
  <head>
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.js"></script>
  </head>
  <body>
    <div>
      <b>订单:</b>
      <div>
        数量: <input id='count' type="number"  required >
      </div>
      <div>
        单价: <input id='cost' type="number"  required >
      </div>
      <div>
        <b>总价:</b>
        <span id="allCost"></span>
        <button class="btn">支付</button>
      </div>
    </div>
  </body>
  <script>
      const $count = $('#count')
      const $cost = $('#cost')

      function genAllCost() {
        $('#allCost').text($count.val() *  $cost.val())
      }

      $count.val('1').on('change', function () {
        genAllCost()
      })

      $cost.val('2').on('change',  function () { 
        genAllCost()
      })
      genAllCost()
   
  </script>
</html>
```

**AngularJS实现**

**view-index.html**

```html
<!doctype html>
<html ng-app="invoice2">
  <head>
    <script src="http://code.angularjs.org/1.2.25/angular.min.js"></script>
    <script src="finance2.js"></script>
    <script src="invoice2.js"></script>
  </head>
  <body>
    <div ng-controller="InvoiceController as invoice">
      <b>订单:</b>
      <div>
        数量: <input type="number" ng-model="invoice.qty" required >
      </div>
      <div>
        单价: <input type="number" ng-model="invoice.cost" required >
        <select ng-model="invoice.inCurr">
          <option ng-repeat="c in invoice.currencies">{{c}}</option>
        </select>
      </div>
      <div>
        <b>总价:</b>
        <span >{{invoice.total('USD')}}</span>
        <button class="btn" ng-click="invoice.pay()">支付</button>
      </div>
    </div>
  </body>
</html>
```

**ctroller-invoice2.js**

```js
angular.module('invoice2', ['finance2'])
  .controller('InvoiceController', ['currencyConverter', function(currencyConverter) {
    this.qty = 1;
    this.cost = 2;
    this.inCurr = 'EUR';
    this.currencies = currencyConverter.currencies;
 
    this.total = function total(outCurr) {
      return currencyConverter.convert(this.qty * this.cost, this.inCurr, outCurr);
    };
    this.pay = function pay() {
      window.alert("谢谢！");
    };
  }]);
```

**service-finance2.js**

```js
angular.module('finance2', [])
  .factory('currencyConverter', function() {
    var currencies = ['USD', 'EUR', 'CNY'],
        usdToForeignRates = {
      USD: 1,
      EUR: 0.74,
      CNY: 6.09
    };
    return {
      currencies: currencies,
      convert: convert
    };
 
    function convert(amount, inCurr, outCurr) {
      return amount * usdToForeignRates[outCurr] * 1 / usdToForeignRates[inCurr];
    }
});
```


通过`AngularJS`与`JQuery`的对比,`AngularJS`发生了以下改变：

1. **从面向`DOM`驱动转变到了面向数据驱动**, 基于数据驱动设计的UI操作，比起基于DOM设计的UI操作更加优秀，下面展示了从简单交互到复杂交互下，`JQuery`和`AngularJS`交互依赖图：

**JQuery单一交互**

![](./jQuerySingleDom.png)

**JQuery交叉交互**

![](./JQueryMutilDOM.png)

**AngularJS单一交互**

![](./reactSingleState.png)

**AngularJS交叉交互**

![](./reactMutilState.png)

2. **单页面应用**

```js
// 可以看到和现在前端路由没什么太大差别
projectApp.config(function($routeProvider){
  $routeProvider.
      when('/', {templateUrl: 'list.html', controller: ProjectListController}).
      when('/project/:id', {templateUrl: 'project.html', controller: ProjectDetailController}).
      otherwise('/');
});
```

3. **自定义指令，可以实现组件，但不完善**

4. **基于`MVC`架构，每层都是单一职责，便于维护**

[这里有一个AngularJS推出时的示例](https://github.com/mhevery/ng-google-io/blob/master/app/scripts/main.js)，这里有一个AnuglarJS设计理念的演讲[Design Decisions in AngularJS](https://www.youtube.com/watch?v=HCR7i5F5L8c)

## 组件化-React

[React的创新之处](https://www.youtube.com/watch?v=XxVg_s8xAms)主要有以下几点：

* 更友好的组件化支持

* Virtual DOM 和 渲染队列优化渲染速度

## MVVM-Vue

* 基于声明式数据驱动视图

## SEO-SSR

React-Next

Vue-Nuxt

Angular-AgularCli自带

## 前框框架需要提供的功能：

* 数据驱动视图

* 单页面

* 组件化

* 数据状态管理

* 跨平台方案(包括服务端渲染)


## 数据驱动方案对比

## 数据状态管理对比

## 跨平台对比


## 三大框架的近期目标

* Vue、React提升性能、减少体积、提供大型项目的逻辑复用机制

* Angular 提升性能、减少体积










## 参考资料


